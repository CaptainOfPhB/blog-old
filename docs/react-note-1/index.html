<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    
    <meta name="author" content="CaptainOfPhB" />

    
	  
	  
	  
	    <title>React 学习笔记（一） ♡ 船长の部落格</title>
	  

    
    
      <meta name="description" content="React 学习笔记（一）" />
    

    
    
    
    <meta name="keywords" content="React" />
    

	  

    <link rel="shortcut icon" href="/images/favicon.png" />

    
    <link rel="stylesheet"  href="https://cdn.jsdelivr.net/npm/reseter.css" >

    <link rel="stylesheet"  href="/css/prism-light.css" >
    <link rel="stylesheet"  href="/css/prism-dark.css" >
    <link rel="stylesheet"  href="/css/base.css" >
    <link rel="stylesheet"  href="/css/light.css" >
    <link rel="stylesheet"  href="/css/dark.css" >
    <link rel="stylesheet"  href="/css/main.css" >
</head>

<body>
    <div class="main">
        <div class="site-nav-container">
  <div class="site-nav">
    <a href="/">首页</a>
    <a href="/posts/">归档</a>
    <a href="/tags/">标签</a>
    <a href="/about-me/">关于</a>
  </div>
</div>

        <div class="content">
            <div class="single">
                <h1 class="title">React 学习笔记（一）</h1>
                <div class="date">Updated&nbsp;on&nbsp;2019.04.16</div>

                

                <div class="markdown">
                    <ol>
<li>React 可能会把多个 setState() 调用合并成一个调用。 因为 this.props 和 this.state 可能会异步更新，所以你不要依赖他们的值来更新下一个状态</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// this.state.count === 0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setState</span>({ <span style="color:#a6e22e">count</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">count</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> });
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setState</span>({ <span style="color:#a6e22e">count</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">count</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> });
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setState</span>({ <span style="color:#a6e22e">count</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">count</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> });
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">count</span>); <span style="color:#75715e">// 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// this.state.count === 0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setState</span>(({ <span style="color:#a6e22e">count</span> }) =&gt; ({ <span style="color:#a6e22e">count</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">count</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> }));
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setState</span>(({ <span style="color:#a6e22e">count</span> }) =&gt; ({ <span style="color:#a6e22e">count</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">count</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> }));
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setState</span>(({ <span style="color:#a6e22e">count</span> }) =&gt; ({ <span style="color:#a6e22e">count</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">count</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> }));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">count</span>); <span style="color:#75715e">// 3
</span></span></span></code></pre></div><ol start="2">
<li>事件处理中，可以使用箭头函数，也可使用 bind，区别在于 bind 可以隐式的将事件对象等传递进去</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span>&lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">onClick</span><span style="color:#f92672">=</span>{(<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">deleteRow</span>(<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">e</span>)}&gt;<span style="color:#a6e22e">Delete</span> <span style="color:#a6e22e">Row</span>&lt;/<span style="color:#f92672">button</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">onClick</span><span style="color:#f92672">=</span>{<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">deleteRow</span>.<span style="color:#a6e22e">bind</span>(<span style="color:#66d9ef">this</span>, <span style="color:#a6e22e">id</span>)}&gt;<span style="color:#a6e22e">Delete</span> <span style="color:#a6e22e">Row</span>&lt;/<span style="color:#f92672">button</span>&gt;
</span></span></code></pre></div><ol start="3">
<li>在这两种情况下，React 的事件对象 e 会被作为第二个参数传递。如果通过箭头函数的方式，事件对象必须显式的进行传递，而通过 bind 的方式，事件对象以及更多的参数将会被隐式的进行传递</li>
<li>组件中 render 返回 null 则组件不会进行渲染，但是生命周期仍然会进行调用</li>
<li>map 生成元素集合的时候必须添加 key，key 在兄弟节点之间必须唯一，key 不会作为 props 传入到子组件内。<a href="https://github.com/dylang/shortid" target="_blank">shortId.js</a>、<a href="https://gist.github.com/gordonbrander/2230317" target="_blank">ID.js</a></li>
<li>受控组件 v.s. 非受控组件 <a href="https://jaredpalmer.com/formik/" target="_blank">Formik.js</a></li>
<li>Fragment &amp; &lt;&gt;&lt;/&gt;、使用 ref 使元素聚焦 this.ref = React.createRef、ref.current.focus()</li>
<li>组件的动态导入 React.lazy(() =&gt; import(&rsquo;./component&rsquo;))、React.Suspense fallback、使用 lazy 动态导入的组件必须使用 Suspense 包裹，使得能有一个回退的 UI</li>
<li>ErrorBoundary 用来处理一些错误边界，常与 Suspense 配合使用，当 Suspense 出现异常时，友好的提示用户，提升体验，内部使用 componentDidCatch 以及 static getDerivedStateFromError 来进行错误处理</li>
<li>基于路由的代码分割配合 React.lazy 或者 React Router 实现</li>
<li>React.lazy 只支持默认导出（export default），若想将命名导出不会被 treeshaking 掉，可使用中间模块，重新导出为默认模块</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// components.js
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">xxx</span> <span style="color:#f92672">=</span> <span style="color:#75715e">/* */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">yyy</span> <span style="color:#f92672">=</span> <span style="color:#75715e">/* */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// component.js
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> {<span style="color:#a6e22e">xxx</span> <span style="color:#a6e22e">as</span> <span style="color:#a6e22e">dafault</span>} <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./components&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//App.js
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">xxx</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">lazy</span>(() =&gt; <span style="color:#66d9ef">import</span>(<span style="color:#e6db74">&#39;./component.js&#39;</span>))
</span></span></code></pre></div><p>完。</p>

                </div>

                <div class="footer">
                    
                    <div class="meta">
                        <span class="field">
                            
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" style="fill: #999; margin-right: 3px;">
                                <path fill="none" d="M0 0h24v24H0z"/>
                                <path d="M7.784 14l.42-4H4V8h4.415l.525-5h2.011l-.525 5h3.989l.525-5h2.011l-.525 5H20v2h-3.784l-.42 4H20v2h-4.415l-.525 5h-2.011l.525-5H9.585l-.525 5H7.049l.525-5H4v-2h3.784zm2.011 0h3.99l.42-4h-3.99l-.42 4z"/>
                            </svg>
                            <a href="/tags/react/">React</a>
                            
                        </span>
                    </div>
                    

                    <div class="divider"></div>

                    <div class="pagination">
                        
                            <a class="pre" href="/commonly-used-git-commands/">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" style="fill: #999;">
                                    <path fill="none" d="M0 0h24v24H0z"/>
                                    <path d="M10.828 12l4.95 4.95-1.414 1.414L8 12l6.364-6.364 1.414 1.414z"/>
                                </svg>
                                <span>我常用的 Git 命令（译）</span>
                            </a>
                        
                        
                            <a class="next" href="/git-note-1/">
                                <span>Git 学习笔记（一）</span>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" style="fill: #999;">
                                    <path fill="none" d="M0 0h24v24H0z"/>
                                    <path d="M13.172 12l-4.95-4.95 1.414-1.414L16 12l-6.364 6.364-1.414-1.414z"/>
                                </svg>
                            </a>
                        
                    </div>

                    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "daijiangtao-blog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/prismjs@1.27.0/components/prism-core.min.js"></script>
<script src="https://unpkg.com/prismjs@1.27.0/plugins/autoloader/prism-autoloader.min.js"></script>
<script src="/js/main.js"></script>
</body>

</html>